<html>

<head>
    <meta charset="uft-8">
    <title>Framwork</title>
    <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.js"></script>
    <link rel="stylesheet" href="{{url_for('static', filename='css/bootstrap.min.css')}}" />
    <script src="{{url_for('static', filename='js/bootstrap.min.js')}}"></script>

    

</head>

<body>


    <div>
        <div id="table1" class="container">
            <table class="table">
                <caption>Table Name</caption>
                <tr>
                    <th>Table Header 1</th>
                    <th>Table Header 2</th>
                    <th>Table Header 3</th>
                </tr>
                <tr>
                    <td>Row 1 Col 1</td>
                    <td>Row 1 Col 2</td>
                    <td>Row 1 Col 3</td>
                </tr>
                <tr>
                    <td>Row 2 Col 1</td>
                    <td>Row 2 Col 2</td>
                    <td>Row 2 Col 3</td>
                </tr>
            </table>
        </div>

        <div class="container"><input type="button" value="Generate a table." onclick="generate_table()"></div>
        <div>
            <table class="table" id="table2"></table>
        </div>
    </div>

   
    
    <div class="container">
       
        <form class="form-horizontal" method="POST" id="result_query_form">
            <div class="form-group">
                <label class="col-sm-2 control-label">UUT</label>
                <div class="col-sm-8">
                    <input type="text" class="form-control" name="uut">
                </div>
                <div><input type="checkbox">Match Whole Words</div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">Notes</label>
                <div class="col-sm-8">
                    <input type="text" class="form-control" name="notes">
                </div>
                <div><input type="checkbox">Match Whole Words</div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">Temperature</label>
                <div class="col-sm-8">
                    <input type="text" class="form-control" name="temperature">
                </div>
                <div><input type="checkbox">Match Whole Words</div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">Date</label>
            </div>
            <div><input type="submit" class="btn btn-default" id='submit'></input></div>
        </form>
    </div>

    <script>
        function generate_table() {
            var body = document.getElementById("table1");
            var tb1 = document.createElement("table");
            var tb1Body = document.createElement("tbody");
            for (var i = 0; i < 2; i++) {
                var row = document.createElement("tr");
                for (var j = 0; j < 2; j++) {
                    var cell = document.createElement("td");
                    var cellText = document.createTextNode("cell in row " + i + ", column " + j);
                    cell.appendChild(cellText);
                    row.appendChild(cell);
                }
                tb1Body.appendChild(row);
            }

            tb1.appendChild(tb1Body);
            body.appendChild(tb1)
            tb1.setAttribute("border", "2");
        }
    </script>

    <script>
        function generateResultTable(data) {
            var tb2 = document.getElementById('table2');
            var data_length = Object.keys(data).length;
            var tbbody = document.createElement("tbody");
            var row = document.createElement("tr");
            Object.keys(data).forEach(function(key) {
                var cell = document.createElement("td");
                var cell_text = document.createTextNode(data[key]);
                cell.appendChild(cell_text);
                row.appendChild(cell);
            });
            tbbody.appendChild(row);
            tb2.appendChild(tbbody);
        }
    </script>

    <script>
        $("form").submit(function (event) {
                // alert( "Handler for .submit() called." );
                event.preventDefault();
                // $.post('/getJSONResult', $("form").serialize(), generateResultTable(this.data), 'json');
                    console.log("post to ajax")
                $.ajax({
                    url: "/getJSONResult",
                    type: 'POST',
                    data: $("form").serialize(),
                    timeout: 4000,
                    dataType: 'json',
                    statusCode: {500: function() { alert('error occur');}},
                    success: function(data) {
                        console.log('successfully get result from server')
                        generateResultTable(data);
                    }
                });
            });
    </script>    


</body>

</html>